<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Plotting functions &#8212; Pyrocko v0.3 Manual</title>
    
    <link rel="stylesheet" href="../../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Pyrocko v0.3 Manual"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Snuffler markers" href="snuffler_markers.html" />
    <link rel="prev" title="Moment Tensor Operations" href="moment_tensor.html" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="shortcut icon" type="image/png" href="../../_static/favicon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=0.8">
    
    
    

  </head>
  <body role="document">
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="responsive-menu"><a href="#sidebar-anchor" title="Navigation">&#9776;</a></li>
        <li><a href="../../index.html">Pyrocko v0.3 Manual</a> &#187;</li>
          <li><a href="../index.html" >Library</a> &#187;</li>
          <li><a href="index.html" accesskey="U">Examples</a> &#187;</li> 
      </ul>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="plotting-functions">
<h1>Plotting functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="generating-topographic-maps-with-automap">
<h2>Generating topographic maps with <code class="docutils literal"><span class="pre">automap</span></code><a class="headerlink" href="#generating-topographic-maps-with-automap" title="Permalink to this headline">¶</a></h2>
<p>The <code class="xref py py-mod docutils literal"><span class="pre">pyrocko.automap</span></code> module provides a painless and clean interface
for the <a class="reference external" href="http://gmt.soest.hawaii.edu/">Generic Mapping Tool (GMT)</a> <a class="footnote-reference" href="#f1" id="id1">[1]</a>.</p>
<dl class="docutils">
<dt>Classes covered in these examples:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="../reference/automap.html#pyrocko.automap.Map" title="pyrocko.automap.Map"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.automap.Map</span></code></a></li>
</ul>
</dd>
<dt>For details on GMT wrapping module:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="../reference/gmtpy.html#module-pyrocko.gmtpy" title="pyrocko.gmtpy"><code class="xref py py-mod docutils literal"><span class="pre">pyrocko.gmtpy</span></code></a></li>
</ul>
</dd>
</dl>
<div class="section" id="topographic-map-of-dead-sea-basin">
<h3>Topographic map of Dead Sea basin<a class="headerlink" href="#topographic-map-of-dead-sea-basin" title="Permalink to this headline">¶</a></h3>
<p>This example demonstrates how to create a map of the Dead Sea area with largest
cities, topography and gives a hint on how to access genuine GMT methods.</p>
<p>Download <a class="reference download internal" href="../../_downloads/automap_example.py" download=""><code class="xref download docutils literal"><span class="pre">automap_example.py</span></code></a></p>
<p>Station file used in the example: <a class="reference download internal" href="../../_downloads/stations_deadsea.pf" download=""><code class="xref download docutils literal"><span class="pre">stations_deadsea.pf</span></code></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyrocko</span> <span class="kn">import</span> <span class="n">model</span>
<span class="kn">from</span> <span class="nn">pyrocko.automap</span> <span class="kn">import</span> <span class="n">Map</span>

<span class="c"># Generate the basic map</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span>
    <span class="n">lat</span><span class="o">=</span><span class="mf">31.5</span><span class="p">,</span>
    <span class="n">lon</span><span class="o">=</span><span class="mf">35.5</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="mf">100000.</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span>
    <span class="n">show_grid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show_topo</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">color_dry</span><span class="o">=</span><span class="p">(</span><span class="mi">238</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">230</span><span class="p">),</span>
    <span class="n">topo_cpt_wet</span><span class="o">=</span><span class="s">&#39;light_sea_uniform&#39;</span><span class="p">,</span>
    <span class="n">topo_cpt_dry</span><span class="o">=</span><span class="s">&#39;light_land_uniform&#39;</span><span class="p">,</span>
    <span class="n">illuminate</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">illuminate_factor_ocean</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">show_rivers</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show_plates</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Draw some larger cities covered by the map area</span>
<span class="n">m</span><span class="o">.</span><span class="n">draw_cities</span><span class="p">()</span>

<span class="c"># Generate with latitute, longitude and labels of the stations</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">load_stations</span><span class="p">(</span><span class="s">&#39;stations_deadsea.pf&#39;</span><span class="p">)</span>
<span class="n">lats</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">lat</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">]</span>
<span class="n">lons</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">lon</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">nsl</span><span class="p">())</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">]</span>

<span class="c"># Stations as black triangles. Genuine GMT commands can be parsed by the maps&#39;</span>
<span class="c"># gmt attribute. Last argument of the psxy function call pipes the maps&#39;</span>
<span class="c"># pojection system.</span>
<span class="n">m</span><span class="o">.</span><span class="n">gmt</span><span class="o">.</span><span class="n">psxy</span><span class="p">(</span><span class="n">in_columns</span><span class="o">=</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">),</span> <span class="n">S</span><span class="o">=</span><span class="s">&#39;t20p&#39;</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">jxyr</span><span class="p">)</span>

<span class="c"># Station labels</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stations</span><span class="p">)):</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">lats</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lons</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c"># Draw a beachball</span>
<span class="n">m</span><span class="o">.</span><span class="n">gmt</span><span class="o">.</span><span class="n">psmeca</span><span class="p">(</span>
    <span class="n">S</span><span class="o">=</span><span class="s">&#39;m.5&#39;</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="s">&#39;5p,0/0/0&#39;</span><span class="p">,</span> <span class="n">in_rows</span><span class="o">=</span><span class="p">[</span>
        <span class="c"># location and moment tensor components (from www.globalcmt.org)</span>
        <span class="p">(</span><span class="mf">35.31</span><span class="p">,</span> <span class="mf">31.62</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.66</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.74</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span>
         <span class="mf">35.31</span><span class="p">,</span> <span class="mf">31.62</span><span class="p">,</span> <span class="s">&#39;Event - 2004/01/11&#39;</span><span class="p">),</span>
    <span class="p">],</span> <span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">jxyr</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;automap_deadsea.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="Map created using automap" src="../../_images/automap_deadsea.jpg" />
</div>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Wessel, P., W. H. F. Smith, R. Scharroo, J. F. Luis, and F. Wobbe, Generic Mapping Tools: Improved version released, EOS Trans. AGU, 94, 409-410, 2013.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="plotting-beachballs-focal-mechanisms">
<h2>Plotting beachballs (focal mechanisms)<a class="headerlink" href="#plotting-beachballs-focal-mechanisms" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Classes covered in these examples:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="../reference/beachball.html#module-pyrocko.beachball" title="pyrocko.beachball"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.beachball</span></code></a> (visual representation of a focal mechanism)</li>
<li><a class="reference internal" href="../reference/moment_tensor.html#module-pyrocko.moment_tensor" title="pyrocko.moment_tensor"><code class="xref py py-mod docutils literal"><span class="pre">pyrocko.moment_tensor</span></code></a> (a 3x3 matrix representation of an
earthquake source)</li>
<li><a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.DCSource" title="pyrocko.gf.seismosizer.DCSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.DCSource</span></code></a> (a representation of a double
couple source object),</li>
<li><a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.RectangularExplosionSource" title="pyrocko.gf.seismosizer.RectangularExplosionSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.RectangularExplosionSource</span></code></a> (a
representation of a rectangular explostion source),</li>
<li><a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.CLVDSource" title="pyrocko.gf.seismosizer.CLVDSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.CLVDSource</span></code></a> (a representation of a
compensated linear vector diploe source object)</li>
<li><a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.DoubleDCSource" title="pyrocko.gf.seismosizer.DoubleDCSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.DoubleDCSource</span></code></a> (a representation of a
double double-couple source object).</li>
</ul>
</dd>
</dl>
<div class="section" id="beachballs-from-moment-tensors">
<h3>Beachballs from moment tensors<a class="headerlink" href="#beachballs-from-moment-tensors" title="Permalink to this headline">¶</a></h3>
<p>This example demonstrates how to create beachballs from (random) moment tensors.</p>
<p>Download <a class="reference download internal" href="../../_downloads/beachball_example01.py" download=""><code class="xref download docutils literal"><span class="pre">beachball_example01.py</span></code></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pyrocko</span> <span class="kn">import</span> <span class="n">beachball</span><span class="p">,</span> <span class="n">moment_tensor</span> <span class="k">as</span> <span class="n">pmt</span>
<span class="kn">from</span> <span class="nn">pyrocko</span> <span class="kn">import</span> <span class="n">util</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">util</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>

    <span class="c"># create random moment tensor</span>
    <span class="n">mt</span> <span class="o">=</span> <span class="n">pmt</span><span class="o">.</span><span class="n">MomentTensor</span><span class="o">.</span><span class="n">random_mt</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c"># create beachball from moment tensor</span>
        <span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span>
            <span class="n">mt</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span>
            <span class="c"># type of beachball: deviatoric, full or double couple (dc)</span>
            <span class="n">beachball_type</span><span class="o">=</span><span class="s">&#39;full&#39;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mf">120.</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mf">10.</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mf">10.</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">beachball</span><span class="o">.</span><span class="n">BeachballError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s"> for MT:</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">mt</span><span class="p">))</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;beachball-example01.pdf&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id2">
<img alt="Beachballs (focal mechanisms) created by moment tensors." src="../../_images/beachball-example01.png" />
<p class="caption"><span class="caption-text">An artistic display of focal mechanisms drawn by classes
<a class="reference internal" href="../reference/beachball.html#module-pyrocko.beachball" title="pyrocko.beachball"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.beachball</span></code></a> and <a class="reference internal" href="../reference/moment_tensor.html#module-pyrocko.moment_tensor" title="pyrocko.moment_tensor"><code class="xref py py-mod docutils literal"><span class="pre">pyrocko.moment_tensor</span></code></a>.</span></p>
</div>
<p>This example shows how to plot a full, a deviatoric and a double-couple beachball
for a moment tensor.</p>
<p>Download <a class="reference download internal" href="../../_downloads/beachball_example03.py" download=""><code class="xref download docutils literal"><span class="pre">beachball_example03.py</span></code></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pyrocko</span> <span class="kn">import</span> <span class="n">beachball</span><span class="p">,</span> <span class="n">moment_tensor</span> <span class="k">as</span> <span class="n">pmt</span><span class="p">,</span> <span class="n">plot</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beachball_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s">&#39;full&#39;</span><span class="p">,</span> <span class="s">&#39;deviatoric&#39;</span><span class="p">,</span> <span class="s">&#39;dc&#39;</span><span class="p">]):</span>
    <span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span>
            <span class="n">pmt</span><span class="o">.</span><span class="n">as_mt</span><span class="p">((</span><span class="mf">124654616.</span><span class="p">,</span> <span class="mf">370943136.</span><span class="p">,</span> <span class="o">-</span><span class="mf">6965434.0</span><span class="p">,</span>
                       <span class="mf">553316224.</span><span class="p">,</span> <span class="o">-</span><span class="mf">307467264.</span><span class="p">,</span> <span class="mf">84703760.0</span><span class="p">)),</span>
            <span class="n">axes</span><span class="p">,</span>
            <span class="n">beachball_type</span><span class="o">=</span><span class="n">beachball_type</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mf">60.</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">color_t</span><span class="o">=</span><span class="n">plot</span><span class="o">.</span><span class="n">mpl_color</span><span class="p">(</span><span class="s">&#39;scarletred2&#39;</span><span class="p">),</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;beachball-example03.pdf&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id3">
<img alt="Beachballs (focal mechanisms) options created from moment tensor" src="../../_images/beachball-example03.png" />
<p class="caption"><span class="caption-text">The three types of beachballs that can be plotted through pyrocko.</span></p>
</div>
</div>
<div class="section" id="beachballs-from-source-objects">
<h3>Beachballs from source objects<a class="headerlink" href="#beachballs-from-source-objects" title="Permalink to this headline">¶</a></h3>
<p>This example shows how to add beachballs of various sizes to the corners of a
plot by obtaining the moment tensor from four different source object types:
<a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.DCSource" title="pyrocko.gf.seismosizer.DCSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.DCSource</span></code></a> (upper left),
<a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.RectangularExplosionSource" title="pyrocko.gf.seismosizer.RectangularExplosionSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.RectangularExplosionSource</span></code></a> (upper right),
<a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.CLVDSource" title="pyrocko.gf.seismosizer.CLVDSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.CLVDSource</span></code></a> (lower left) and
<a class="reference internal" href="../reference/gf.html#pyrocko.gf.seismosizer.DoubleDCSource" title="pyrocko.gf.seismosizer.DoubleDCSource"><code class="xref py py-class docutils literal"><span class="pre">pyrocko.gf.seismosizer.DoubleDCSource</span></code></a> (lower right).</p>
<p>Creating the beachball this ways allows for finer control over their location
based on their size (in display units) which allows for a round beachball even
if the axis are not 1:1.</p>
<p>Download <a class="reference download internal" href="../../_downloads/beachball_example02.py" download=""><code class="xref download docutils literal"><span class="pre">beachball_example02.py</span></code></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">transforms</span><span class="p">,</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pyrocko</span> <span class="kn">import</span> <span class="n">beachball</span><span class="p">,</span> <span class="n">gf</span>

<span class="c"># create source object</span>
<span class="n">source1</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">DCSource</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mf">35e3</span><span class="p">,</span> <span class="n">strike</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="mf">90.</span><span class="p">,</span> <span class="n">rake</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c"># set size of beachball</span>
<span class="n">sz</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="c"># set beachball offset in points (one point from each axis)</span>
<span class="n">szpt</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">72.</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">72.</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c"># get the bounding point (left-top)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># create a translation matrix, based on the final figure size and</span>
<span class="c"># beachball location</span>
<span class="n">move_trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ScaledTranslation</span><span class="p">(</span><span class="n">szpt</span><span class="p">,</span> <span class="o">-</span><span class="n">szpt</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="p">)</span>

<span class="c"># get the inverse matrix for the axis where the beachball will be plotted</span>
<span class="n">inv_trans</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>

<span class="c"># set the bouding point relative to the plotted axis of the beachball</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">inv_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">move_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))))</span>

<span class="c"># plot beachball</span>
<span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span><span class="n">source1</span><span class="o">.</span><span class="n">pyrocko_moment_tensor</span><span class="p">(),</span> <span class="n">ax</span><span class="p">,</span>
                             <span class="n">beachball_type</span><span class="o">=</span><span class="s">&#39;full&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span>
                             <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>


<span class="c"># create source object</span>
<span class="n">source2</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">RectangularExplosionSource</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mf">35e3</span><span class="p">,</span> <span class="n">strike</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="mf">90.</span><span class="p">)</span>

<span class="c"># set size of beachball</span>
<span class="n">sz</span> <span class="o">=</span> <span class="mf">30.</span>
<span class="c"># set beachball offset in points (one point from each axis)</span>
<span class="n">szpt</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">72.</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">72.</span>

<span class="c"># get the bounding point (right-upper)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># create a translation matrix, based on the final figure size and</span>
<span class="c"># beachball location</span>
<span class="n">move_trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ScaledTranslation</span><span class="p">(</span><span class="o">-</span><span class="n">szpt</span><span class="p">,</span> <span class="o">-</span><span class="n">szpt</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="p">)</span>

<span class="c"># get the inverse matrix for the axis where the beachball will be plotted</span>
<span class="n">inv_trans</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>

<span class="c"># set the bouding point relative to the plotted axis of the beachball</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">inv_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">move_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))))</span>

<span class="c"># plot beachball</span>
<span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span><span class="n">source2</span><span class="o">.</span><span class="n">pyrocko_moment_tensor</span><span class="p">(),</span> <span class="n">ax</span><span class="p">,</span>
                             <span class="n">beachball_type</span><span class="o">=</span><span class="s">&#39;full&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span>
                             <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>


<span class="c"># create source object</span>
<span class="n">source3</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">CLVDSource</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">35e6</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span>

<span class="c"># set size of beachball</span>
<span class="n">sz</span> <span class="o">=</span> <span class="mf">40.</span>
<span class="c"># set beachball offset in points (one point from each axis)</span>
<span class="n">szpt</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">72.</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">72.</span>

<span class="c"># get the bounding point (left-bottom)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># create a translation matrix, based on the final figure size and</span>
<span class="c"># beachball location</span>
<span class="n">move_trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ScaledTranslation</span><span class="p">(</span><span class="n">szpt</span><span class="p">,</span> <span class="n">szpt</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="p">)</span>

<span class="c"># get the inverse matrix for the axis where the beachball will be plotted</span>
<span class="n">inv_trans</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>

<span class="c"># set the bouding point relative to the plotted axis of the beachball</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">inv_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">move_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))))</span>

<span class="c"># plot beachball</span>
<span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span><span class="n">source3</span><span class="o">.</span><span class="n">pyrocko_moment_tensor</span><span class="p">(),</span> <span class="n">ax</span><span class="p">,</span>
                             <span class="n">beachball_type</span><span class="o">=</span><span class="s">&#39;full&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span>
                             <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>

<span class="c"># create source object</span>
<span class="n">source4</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">DoubleDCSource</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mf">35e3</span><span class="p">,</span> <span class="n">strike1</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dip1</span><span class="o">=</span><span class="mf">90.</span><span class="p">,</span> <span class="n">rake1</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                            <span class="n">strike2</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span> <span class="n">dip2</span><span class="o">=</span><span class="mf">74.</span><span class="p">,</span> <span class="n">rake2</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c"># set size of beachball</span>
<span class="n">sz</span> <span class="o">=</span> <span class="mf">50.</span>
<span class="c"># set beachball offset in points (one point from each axis)</span>
<span class="n">szpt</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">72.</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">72.</span>

<span class="c"># get the bounding point (right-bottom)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># create a translation matrix, based on the final figure size and</span>
<span class="c"># beachball location</span>
<span class="n">move_trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ScaledTranslation</span><span class="p">(</span><span class="o">-</span><span class="n">szpt</span><span class="p">,</span> <span class="n">szpt</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="p">)</span>

<span class="c"># get the inverse matrix for the axis where the beachball will be plotted</span>
<span class="n">inv_trans</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>

<span class="c"># set the bouding point relative to the plotted axis of the beachball</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">inv_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">move_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">))))</span>

<span class="c"># plot beachball</span>
<span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span><span class="n">source4</span><span class="o">.</span><span class="n">pyrocko_moment_tensor</span><span class="p">(),</span> <span class="n">ax</span><span class="p">,</span>
                             <span class="n">beachball_type</span><span class="o">=</span><span class="s">&#39;full&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span>
                             <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;beachball-example02.pdf&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id4">
<img alt="Beachballs (focal mechanisms) created in corners of graph." src="../../_images/beachball-example02.png" />
<p class="caption"><span class="caption-text">Four different source object types plotted with different beachball sizes.</span></p>
</div>
</div>
<div class="section" id="add-station-symbols-to-focal-sphere-diagram">
<h3>Add station symbols to focal sphere diagram<a class="headerlink" href="#add-station-symbols-to-focal-sphere-diagram" title="Permalink to this headline">¶</a></h3>
<p>This example shows how to add station symbols at the positions where P wave
rays pierce the focal sphere.</p>
<p>The function to plot focal spheres
(<a class="reference internal" href="../reference/beachball.html#pyrocko.beachball.plot_beachball_mpl" title="pyrocko.beachball.plot_beachball_mpl"><code class="xref py py-func docutils literal"><span class="pre">pyrocko.beachball.plot_beachball_mpl()</span></code></a>) uses the function
<code class="xref py py-func docutils literal"><span class="pre">pyrocko.beachball.project()</span></code> in the final projection from 3D to 2D
coordinates. Here we use this function to place additional symbols on the plot.
The take-off angles needed can be computed with some help of the
<a class="reference internal" href="../reference/cake.html#module-pyrocko.cake" title="pyrocko.cake"><code class="xref py py-mod docutils literal"><span class="pre">pyrocko.cake</span></code></a> module. Azimuth and distance computations are done with
functions from <a class="reference internal" href="../reference/orthodrome.html#module-pyrocko.orthodrome" title="pyrocko.orthodrome"><code class="xref py py-mod docutils literal"><span class="pre">pyrocko.orthodrome</span></code></a>.</p>
<p>Download <a class="reference download internal" href="../../_downloads/beachball_example04.py" download=""><code class="xref download docutils literal"><span class="pre">beachball_example04.py</span></code></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">num</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pyrocko</span> <span class="kn">import</span> <span class="n">moment_tensor</span> <span class="k">as</span> <span class="n">pmt</span><span class="p">,</span> <span class="n">beachball</span><span class="p">,</span> <span class="n">cake</span><span class="p">,</span> <span class="n">orthodrome</span>

<span class="n">km</span> <span class="o">=</span> <span class="mf">1000.</span>

<span class="c"># source position and mechanism</span>
<span class="n">slat</span><span class="p">,</span> <span class="n">slon</span><span class="p">,</span> <span class="n">sdepth</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="o">*</span><span class="n">km</span>
<span class="n">mt</span> <span class="o">=</span> <span class="n">pmt</span><span class="o">.</span><span class="n">MomentTensor</span><span class="o">.</span><span class="n">random_dc</span><span class="p">()</span>

<span class="c"># receiver positions</span>
<span class="n">rdepth</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">rlatlons</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">),</span> <span class="p">(</span><span class="mf">60.</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">30.</span><span class="p">,</span> <span class="mf">60.</span><span class="p">)]</span>

<span class="c"># earth model and phase for takeoff angle computations</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">cake</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s">&#39;ak135-f-continental.m&#39;</span><span class="p">)</span>
<span class="n">phases</span> <span class="o">=</span> <span class="n">cake</span><span class="o">.</span><span class="n">PhaseDef</span><span class="o">.</span><span class="n">classic</span><span class="p">(</span><span class="s">&#39;P&#39;</span><span class="p">)</span>

<span class="c"># setup figure with aspect=1.0/1.0, ranges=[-1.1, 1.1]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>  <span class="c"># size in inch</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

<span class="n">projection</span> <span class="o">=</span> <span class="s">&#39;lambert&#39;</span>

<span class="n">beachball</span><span class="o">.</span><span class="n">plot_beachball_mpl</span><span class="p">(</span>
    <span class="n">mt</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">color_t</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">),</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
    <span class="n">size_units</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">rlat</span><span class="p">,</span> <span class="n">rlon</span> <span class="ow">in</span> <span class="n">rlatlons</span><span class="p">:</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">orthodrome</span><span class="o">.</span><span class="n">distance_accurate50m</span><span class="p">(</span><span class="n">slat</span><span class="p">,</span> <span class="n">slon</span><span class="p">,</span> <span class="n">rlat</span><span class="p">,</span> <span class="n">rlon</span><span class="p">)</span>
    <span class="n">rays</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">arrivals</span><span class="p">(</span>
        <span class="n">phases</span><span class="o">=</span><span class="n">cake</span><span class="o">.</span><span class="n">PhaseDef</span><span class="p">(</span><span class="s">&#39;P&#39;</span><span class="p">),</span>
        <span class="n">zstart</span><span class="o">=</span><span class="n">sdepth</span><span class="p">,</span> <span class="n">zstop</span><span class="o">=</span><span class="n">rdepth</span><span class="p">,</span> <span class="n">distances</span><span class="o">=</span><span class="p">[</span><span class="n">distance</span><span class="o">*</span><span class="n">cake</span><span class="o">.</span><span class="n">m2d</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">rays</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="n">takeoff</span> <span class="o">=</span> <span class="n">rays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">takeoff_angle</span><span class="p">()</span>
    <span class="n">azi</span> <span class="o">=</span> <span class="n">orthodrome</span><span class="o">.</span><span class="n">azimuth</span><span class="p">(</span><span class="n">slat</span><span class="p">,</span> <span class="n">slon</span><span class="p">,</span> <span class="n">rlat</span><span class="p">,</span> <span class="n">rlon</span><span class="p">)</span>

    <span class="c"># to spherical coordinates, r, theta, phi in radians</span>
    <span class="n">rtp</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">num</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">takeoff</span><span class="p">),</span> <span class="n">num</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">90.</span><span class="o">-</span><span class="n">azi</span><span class="p">)]])</span>

    <span class="c"># to 3D coordinates (x, y, z)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">beachball</span><span class="o">.</span><span class="n">numpy_rtp2xyz</span><span class="p">(</span><span class="n">rtp</span><span class="p">)</span>

    <span class="c"># project to 2D with same projection as used in beachball</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">beachball</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;beachball-example04.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id5">
<img alt="Focal sphere diagram with station symbols" src="../../_images/beachball-example04.png" />
<p class="caption"><span class="caption-text">Focal sphere diagram with markers at positions of P wave ray piercing points.</span></p>
</div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
    &nbsp;
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="snuffler_markers.html" title="Snuffler markers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="moment_tensor.html" title="Moment Tensor Operations"
             accesskey="P">previous</a> |</li>
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, The Pyrocko Developers.
    </div>
  </body>
</html>